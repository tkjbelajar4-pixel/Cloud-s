<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neverlabs Cloud's</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3E%3Cpath fill='%23ffffff' d='M0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4 4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336z'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://upload-widget.cloudinary.com/global/all.js"></script>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="mobileDrawer">
            <div class="sidebar-header">
                <h2>Neverlabs Cloud's</h2>
                <button class="drawer-folder-btn" id="drawerFolderBtn"><i class="fas fa-folder"></i></button>
            </div>
            <nav class="folder-tree" id="folderTree"></nav>
            <div class="sidebar-footer">
                <span class="admin-text"><b>Administrator</b></span>
                <button id="settingsBtn" class="btn-icon"><i class="fas fa-cog"></i></button>
            </div>
        </aside>

        <div class="drawer-overlay" id="drawerOverlay"></div>

        <main class="main-content">
            <header class="content-header">
                <h3 id="currentFolderTitle">Root</h3>
                <span class="mobile-header-title">Neverlabs Cloud's</span>
                <button id="drawerToggleBtn"><i class="fas fa-folder"></i></button>
                <div class="header-buttons">
                    <button id="uploadBtn" class="btn-primary"><i class="fas fa-upload"></i> <span>Upload Media</span></button>
                    <button id="newFolderBtn" class="btn-primary"><i class="fas fa-folder-plus"></i> <span>Folder Baru</span></button>
                    <button id="newTextNoteBtn" class="btn-primary"><i class="fas fa-file-alt"></i> <span>Buat Teks</span></button>
                </div>
            </header>
            <div class="file-grid" id="fileGrid"></div>
        </main>
    </div>

    <div id="folderModal" class="modal">
        <div class="modal-content">
            <h3>Buat Folder Baru</h3>
            <input type="text" id="folderNameInput" placeholder="Nama folder" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelFolderBtn">Batal</button>
                <button id="saveFolderBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="uploadMetaModal" class="modal">
        <div class="modal-content">
            <h3>Detail Media</h3>
            <input type="text" id="mediaNameInput" placeholder="Nama tampilan" autocomplete="off">
            <select id="mediaFolderSelect"></select>
            <div class="modal-actions">
                <button id="cancelMetaBtn">Batal</button>
                <button id="saveMetaBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="renameModal" class="modal">
        <div class="modal-content">
            <h3>Ubah Nama</h3>
            <input type="text" id="renameInput" placeholder="Nama baru" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelRenameBtn">Batal</button>
                <button id="saveRenameBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="deleteConfirmModal" class="modal">
        <div class="modal-content">
            <h3>Hapus Item</h3>
            <p>Apakah Anda yakin ingin menghapus item ini?</p>
            <div class="modal-actions">
                <button id="cancelDeleteBtn">Batal</button>
                <button id="confirmDeleteBtn" class="btn-primary" style="background-color:#b33;">Hapus</button>
            </div>
        </div>
    </div>

    <div id="textNoteModal" class="modal">
        <div class="modal-content" style="max-width:600px;">
            <h3>Buat Catatan Teks Baru</h3>
            <input type="text" id="textNoteName" placeholder="Nama catatan" autocomplete="off" class="code-editor-textarea" style="margin-bottom:16px;">
            <textarea id="textNoteContent" placeholder="Isi teks..." rows="10" class="code-editor-textarea"></textarea>
            <div class="modal-actions">
                <button id="cancelTextNoteBtn" class="btn-secondary">Batal</button>
                <button id="saveTextNoteBtn" class="btn-secondary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="setupModal" class="modal">
        <div class="modal-content" style="max-width:600px;">
            <h3>Konfigurasi Cloudinary</h3>
            <p style="margin-bottom:15px; color:#b0c4de;">Masukkan konfigurasi untuk media (gambar/video) dan teks (file teks). Data ini disimpan hanya di perangkat Anda.</p>

            <h4 style="color:#d6e3ff; margin-bottom:10px;">Media Storage</h4>
            <p style="font-size:0.9rem; background:#1a1d23; padding:10px; border-radius:8px;">
                <strong>Cara mendapatkannya:</strong><br>
                1. Daftar/login di <a href="https://cloudinary.com" target="_blank" style="color:#7f9fcf;">Cloudinary</a><br>
                2. Salin <strong>Cloud Name</strong> dari dashboard.<br>
                3. Buat <strong>Upload Preset</strong> (Settings > Upload > Add upload preset, pilih unsigned).<br>
            </p>
            <input type="text" id="setupCloudName" placeholder="Media Cloud Name" autocomplete="off">
            <input type="text" id="setupUploadPreset" placeholder="Media Upload Preset" autocomplete="off">
            <input type="text" id="setupApiKey" placeholder="Media API Key (opsional)" autocomplete="off">
            <input type="password" id="setupApiSecret" placeholder="Media API Secret (opsional)" autocomplete="off">

            <h4 style="color:#d6e3ff; margin:20px 0 10px;">Text Storage</h4>
            <p style="font-size:0.9rem; background:#1a1d23; padding:10px; border-radius:8px;">
                <strong>Gunakan Cloudinary juga untuk teks, atau isi dengan layanan lain (Backblaze B2, dll) - untuk demo kita pakai Cloudinary.</strong><br>
                Jika menggunakan Cloudinary, buat upload preset terpisah untuk raw file.
            </p>
            <input type="text" id="setupTextCloudName" placeholder="Text Cloud Name" autocomplete="off">
            <input type="text" id="setupTextUploadPreset" placeholder="Text Upload Preset" autocomplete="off">
            <input type="text" id="setupTextApiKey" placeholder="Text API Key (opsional)" autocomplete="off">
            <input type="password" id="setupTextApiSecret" placeholder="Text API Secret (opsional)" autocomplete="off">

            <div class="modal-actions">
                <button id="setupCancelBtn">Batal</button>
                <button id="setupSaveBtn" class="btn-secondary">Simpan</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/app.js"></script>
    <script>
        (function() {
            const drawer = document.getElementById('mobileDrawer');
            const overlay = document.getElementById('drawerOverlay');
            const toggleBtn = document.getElementById('drawerToggleBtn');
            const drawerFolderBtn = document.getElementById('drawerFolderBtn');

            function openDrawer() {
                drawer.classList.add('open');
                overlay.classList.add('active');
            }

            function closeDrawer() {
                drawer.classList.remove('open');
                overlay.classList.remove('active');
            }

            toggleBtn.addEventListener('click', openDrawer);
            drawerFolderBtn.addEventListener('click', closeDrawer);
            overlay.addEventListener('click', closeDrawer);

            let touchStartX = 0;
            let touchEndX = 0;

            document.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, false);

            document.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, false);

            function handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                if (swipeDistance > 50 && touchStartX < 30) {
                    openDrawer();
                } else if (swipeDistance < -50 && drawer.classList.contains('open')) {
                    closeDrawer();
                }
            }
        })();
    </script>
</body>
</html>
