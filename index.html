<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neverlabs Cloud's</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3E%3Cpath fill='%23ffffff' d='M0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4 4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336z'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="mobileDrawer">
            <div class="sidebar-header">
                <h2>Neverlabs Cloud's</h2>
                <button class="drawer-folder-btn" id="drawerFolderBtn"><i class="fas fa-folder"></i></button>
            </div>
            <nav class="folder-tree" id="folderTree"></nav>
            <div class="sidebar-footer">
                <span class="admin-text"><b>Administrator</b></span>
                <button id="settingsBtn" class="btn-icon"><i class="fas fa-cog"></i></button>
            </div>
        </aside>

        <div class="drawer-overlay" id="drawerOverlay"></div>

        <main class="main-content">
            <header class="content-header">
                <div class="header-left">
                    <h3 id="currentFolderTitle">Root</h3>
                    <span class="mobile-header-title" id="mobileTitle">Neverlabs Cloud's</span>
                </div>
                <div class="header-right">
                    <div class="desktop-search">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="searchInput" placeholder="Search Root">
                    </div>
                    <div class="mobile-search">
                        <input type="text" id="mobileSearchInput" placeholder="Cari...">
                    </div>
                    <button id="exitHiddenBtn" class="btn-icon" title="Keluar dari folder tersembunyi" style="display: none;"><i class="fas fa-door-open"></i></button>
                    <button id="drawerToggleBtn"><i class="fas fa-folder"></i></button>
                    <div class="header-buttons">
                        <button id="exitHiddenBtnMobile" class="btn-icon" title="Keluar" style="display: none;"><i class="fas fa-door-open"></i></button>
                        <button id="uploadBtn" class="btn-icon" title="Upload Media"><i class="fas fa-upload"></i></button>
                        <button id="newFolderBtn" class="btn-icon" title="Folder Baru"><i class="fas fa-folder-plus"></i></button>
                        <button id="newTextNoteBtn" class="btn-icon" title="Buat Teks"><i class="fas fa-file-alt"></i></button>
                    </div>
                </div>
            </header>
            <div class="file-grid" id="fileGrid"></div>
        </main>
    </div>

    <div id="folderModal" class="modal">
        <div class="modal-content">
            <h3>Buat Folder Baru</h3>
            <input type="text" id="folderNameInput" placeholder="Nama folder" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelFolderBtn">Batal</button>
                <button id="saveFolderBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="uploadMetaModal" class="modal">
        <div class="modal-content">
            <h3>Detail Media</h3>
            <input type="text" id="mediaNameInput" placeholder="Nama tampilan" autocomplete="off">
            <select id="mediaFolderSelect"></select>
            <div class="modal-actions">
                <button id="cancelMetaBtn">Batal</button>
                <button id="saveMetaBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="renameModal" class="modal">
        <div class="modal-content">
            <h3>Ubah Nama</h3>
            <input type="text" id="renameInput" placeholder="Nama baru" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelRenameBtn">Batal</button>
                <button id="saveRenameBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="deleteConfirmModal" class="modal">
        <div class="modal-content">
            <h3>Hapus Item</h3>
            <p>Apakah Anda yakin ingin menghapus item ini?</p>
            <div class="modal-actions">
                <button id="cancelDeleteBtn">Batal</button>
                <button id="confirmDeleteBtn" class="btn-primary" style="background-color:#b33;">Hapus</button>
            </div>
        </div>
    </div>

    <div id="textNoteModal" class="modal">
        <div class="modal-content" style="max-width:600px;">
            <h3>Buat Catatan Teks Baru</h3>
            <input type="text" id="textNoteName" placeholder="Nama catatan" autocomplete="off" class="code-editor-textarea" style="margin-bottom:16px;">
            <textarea id="textNoteContent" placeholder="Isi teks..." rows="10" class="code-editor-textarea"></textarea>
            <div class="modal-actions">
                <button id="cancelTextNoteBtn" class="btn-secondary">Batal</button>
                <button id="saveTextNoteBtn" class="btn-secondary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="hiddenPasswordModal" class="modal">
        <div class="modal-content">
            <h3 id="hiddenModalTitle">Masukkan Password</h3>
            <input type="password" id="hiddenPasswordInput" placeholder="Password" autocomplete="off">
            <div id="hiddenQuestionSection" style="display:none;">
                <input type="text" id="hiddenQuestionInput" placeholder="Pertanyaan" autocomplete="off">
                <input type="text" id="hiddenAnswerInput" placeholder="Jawaban" autocomplete="off">
            </div>
            <div id="hiddenRecoverySection" style="display:none;">
                <p style="color:#ffaa33;">Password salah 3 kali. Jawab pertanyaan untuk memulihkan.</p>
                <input type="text" id="recoveryAnswerInput" placeholder="Jawaban pertanyaan" autocomplete="off">
            </div>
            <div class="modal-actions">
                <button id="hiddenCancelBtn">Batal</button>
                <button id="hiddenSubmitBtn" class="btn-primary">OK</button>
            </div>
        </div>
    </div>

    <div id="hiddenChangePasswordModal" class="modal">
        <div class="modal-content">
            <h3>Ubah Password</h3>
            <input type="password" id="oldPasswordInput" placeholder="Password lama" autocomplete="off">
            <input type="password" id="newPasswordInput" placeholder="Password baru" autocomplete="off">
            <input type="password" id="confirmPasswordInput" placeholder="Konfirmasi password baru" autocomplete="off">
            <input type="text" id="newQuestionInput" placeholder="Pertanyaan baru (opsional)" autocomplete="off">
            <input type="text" id="newAnswerInput" placeholder="Jawaban baru (opsional)" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelChangeBtn">Batal</button>
                <button id="saveChangeBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="hiddenRecoverModal" class="modal">
        <div class="modal-content">
            <h3>Pulihkan Password</h3>
            <input type="password" id="recoverNewPassword" placeholder="Password baru" autocomplete="off">
            <input type="password" id="recoverConfirmPassword" placeholder="Konfirmasi password baru" autocomplete="off">
            <input type="text" id="recoverNewQuestion" placeholder="Pertanyaan baru (opsional)" autocomplete="off">
            <input type="text" id="recoverNewAnswer" placeholder="Jawaban baru (opsional)" autocomplete="off">
            <div class="modal-actions">
                <button id="cancelRecoverBtn">Batal</button>
                <button id="saveRecoverBtn" class="btn-primary">Simpan</button>
            </div>
        </div>
    </div>

    <div id="setupModal" class="modal">
        <div class="modal-content">
            <h3>Tentang Aplikasi</h3>
            <p style="margin-bottom:20px; color:#b0c4de;">Neverlabs Cloud's â€” penyimpanan file lokal di browser Anda.</p>
            
            <h4 style="color:#d6e3ff; margin-bottom:10px;">Kontak Kami</h4>
            <div class="contact-grid">
                <a href="mailto:userlinuxorg@gmail.com"><i class="fas fa-envelope"></i> userlinuxorg@gmail.com</a>
                <a href="https://instagram.com/neveerlabs" target="_blank"><i class="fab fa-instagram"></i> @neveerlabs</a>
                <a href="https://wa.me/628561765372" target="_blank"><i class="fab fa-whatsapp"></i> +62 856-1765-372</a>
                <a href="https://github.com/neveerlabs" target="_blank"><i class="fab fa-github"></i> neveerlabs</a>
                <a href="https://t.me/Neverlabs" target="_blank"><i class="fab fa-telegram"></i> @Neverlabs</a>
            </div>

            <h4 style="color:#d6e3ff; margin-bottom:10px;">Informasi</h4>
            <div class="info-grid">
                <a href="https://github.com/nflora-ux/Cloud-s/blob/6420f17752e44e7fcb80f2da30a237326259fd6c/LICENSE" target="_blank">Lisensi MIT</a>
                <a href="https://github.com/nflora-ux/Cloud-s/blob/6420f17752e44e7fcb80f2da30a237326259fd6c/PRIVACY.md" target="_blank">Kebijakan Privasi</a>
            </div>

            <h4 style="color:#d6e3ff; margin-bottom:10px;">Data</h4>
            <div class="data-buttons">
                <button id="exportDataBtn" class="btn-secondary">Ekspor Data</button>
                <button id="deleteAllDataBtn" class="btn-secondary" style="color:#b33;">Hapus Semua Data</button>
            </div>

            <h4 style="color:#d6e3ff; margin-bottom:10px;">Folder Tersembunyi</h4>
            <div class="data-buttons">
                <button id="changeHiddenPasswordBtn" class="btn-secondary">Ubah Password</button>
                <button id="deleteHiddenPasswordBtn" class="btn-secondary" style="color:#b33;">Hapus Password</button>
            </div>

            <div class="modal-actions">
                <button id="aboutCloseBtn" class="btn-secondary">Tutup</button>
            </div>
        </div>
    </div>

    <script src="js/storage.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/app.js"></script>
    <script>
        (function() {
            const drawer = document.getElementById('mobileDrawer');
            const overlay = document.getElementById('drawerOverlay');
            const toggleBtn = document.getElementById('drawerToggleBtn');
            const drawerFolderBtn = document.getElementById('drawerFolderBtn');

            function openDrawer() {
                drawer.classList.add('open');
                overlay.classList.add('active');
            }

            function closeDrawer() {
                drawer.classList.remove('open');
                overlay.classList.remove('active');
            }

            toggleBtn.addEventListener('click', openDrawer);
            drawerFolderBtn.addEventListener('click', closeDrawer);
            overlay.addEventListener('click', closeDrawer);

            let touchStartX = 0;
            let touchEndX = 0;

            document.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
            }, false);

            document.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }, false);

            function handleSwipe() {
                const swipeDistance = touchEndX - touchStartX;
                if (swipeDistance > 50 && touchStartX < 30) {
                    openDrawer();
                } else if (swipeDistance < -50 && drawer.classList.contains('open')) {
                    closeDrawer();
                }
            }
        })();
    </script>
</body>
</html>
